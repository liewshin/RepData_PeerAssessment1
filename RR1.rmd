Reproducible Research - Course Project 1
========================================

Introduction

It is now possible to collect a large amount of data about personal movement using activity monitoring devices such as a Fitbit, Nike Fuelband, or Jawbone Up. These type of devices are part of the “quantified self” movement – a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. But these data remain under-utilized both because the raw data are hard to obtain and there is a lack of statistical methods and software for processing and interpreting the data.

This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.

The data for this assignment can be downloaded from the course web site:

[Activity Monitoring Data](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip)

We will first load up the data
```{r, results = "hide"}
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", destfile = "repdata_data_activity.zip")
unzip("repdata_data_activity.zip")
activity <- read.csv("activity.csv")
```

First, we would like to look at the total number of steps taken per day. We would have to remove the missing data. We can achieve both of these through the use of the aggregate() function.
```{r}
dailystepstotal <- aggregate(steps ~ date, activity, sum)
```

We also note that the class of the date columns in dailystepsmean is a factor. Thus, we would need to transform it to a date format for plotting. We can then produce a simple plot from the data.
```{r}
class(dailystepstotal$date)
dailystepstotal$date <- as.Date(dailystepstotal$date, "%Y-%m-%d")
class(dailystepstotal$date)
plot(dailystepstotal)
```

We would then like to see a histogram of the total number of steps each day. To do that, we can plot using the hist() function.
```{r}
hist(dailystepstotal$steps, 
     main = "Total Number of Steps Taken Each Day", 
     xlab = "Number of Steps")
```

To look into the mean and median of total number of steps each day, we make use of the tapply() function.
```{r}
mean(dailystepstotal$steps)
median(dailystepstotal$steps)
```

Now, we would like to look into the average daily activity pattern. To do that, we will make a time series plot.
```{r}
dailystepsmean <- aggregate(steps ~ interval, activity, mean)
plot(dailystepsmean$interval,dailystepsmean$steps, 
     type = "l",
     main = "Daily Activity",
     xlab = "Time Interval (min)",
     ylab = "Average Number of Steps")
```

To find the 5 minute interval where the greatest average number of steps is recorded, we can subset the row where the maximum number of steps can be found.
```{r}
dailystepsmean[dailystepsmean$steps == max(dailystepsmean$steps),]
```

We are now interested in looking into the number of missing values in the dataset.
```{r}
sum(is.na(activity))
```

With all the missing values present in this dataset, one might wonder what the actual dataset would be like with all the values filled in. We can emulate that by imputing all the NA values with the weighted moving average with k=5 in the given day. This can be done using the imputeTS package.
```{r}
library(imputeTS)
newactivity <- na_ma(activity, k = 5)
```

We can then make a histogram of the total number of steps taken each day using the new dataset.
```{r}
newdailystepstotal <- aggregate(steps ~ date, newactivity, sum)
hist(newdailystepstotal$steps,
     main = "Total Number of Steps Taken Each Day",
     xlab = "Number of Steps",
     )
```

We can also look at the mean and median of the new dataset.
```{r}
mean(newdailystepstotal$steps)
median(newdailystepstotal$steps)
```

We can see that the value of the mean is reduced by quite a bit from the original dataset, but the median is roughly about the same, albeit slightly lower. This can also be seen in the histogram, where the frequency of steps below 5000 per day also increased. As we imputed the dataset, the missing data took on the moving average of the k=5 nearest neighbours, most of which were often close to 0. Thus, it would make sense that the imputed dataset has a lowered mean. Also, since the total number of steps taken each day follows a normal distribution with its peak around the 10000 to 15000 steps in both datasets, it would also make sense that the median remained relatively unchanges.

Next, we would like to split the dataset into weekdays and weekends. To do this, we make use of the weekdays() to separate out the rows based on the day of the week, and the ifelse() function to label them. We can then bind these using the cbind() function.
```{r}
newactivity$date <- as.Date(newactivity$date, "%Y-%m-%d")
day.of.week <- weekdays(newactivity$date)
day.of.week <- ifelse(day.of.week %in% c("Saturday", "Sunday"), "weekend", "weekday")
newactivity <- cbind(newactivity,day.of.week)
```

We can then look into the mean number of steps on weekdays and weekends by subsetting the dataset.
```{r}
weekday <- subset(newactivity, day.of.week == "weekday")
weekend <- subset(newactivity, day.of.week == "weekend")
newdailystepsweekday <- aggregate(steps ~ interval, weekday, mean)
newdailystepsweekend <- aggregate(steps ~ interval, weekend, mean)
```

We can then make a panel plot with a time series plot of the average number of steps taken in both weekdays and weekend.
```{r}
par(mfcol = c(2,1))
par(mar = c(4, 4, 3, 1))
plot(newdailystepsweekday,
     type = "l",
     main = "weekday")
plot(newdailystepsweekend,
     type = "l",
     main = "weekend")
```